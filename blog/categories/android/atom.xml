<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: android | ktkr3d]]></title>
  <link href="http://ktkr3d.github.io/blog/categories/android/atom.xml" rel="self"/>
  <link href="http://ktkr3d.github.io/"/>
  <updated>2013-11-04T00:09:25+09:00</updated>
  <id>http://ktkr3d.github.io/</id>
  <author>
    <name><![CDATA[ktkr3d]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Irrlicht Android Media Player]]></title>
    <link href="http://ktkr3d.github.io/blog/2013/08/11/irrlicht-android-media-player/"/>
    <updated>2013-08-11T03:47:00+09:00</updated>
    <id>http://ktkr3d.github.io/blog/2013/08/11/irrlicht-android-media-player</id>
    <content type="html"><![CDATA[<p><a href="http://ktkr3d.github.io/images/irrlicht_android_player_tab.png"><img src="/images/irrlicht_android_player_tab_tn.png"></a></p>

<p>Android のNative Activity で実装したアプリからオーディオの再生ができたので、ミクさんが踊ってくれるメディアプレイヤー的なものにしてみました。</p>

<!-- more -->


<h4>PMD とVMD のロード処理の修正</h4>

<p>以前のソースコードがHDD の故障とともに消えてしまったので、コードやMakefile を書きなおしていたところ、うまくロードできないPMD、VMD があることに気が付きました。
BinaryReader のロード処理で、プロセッサ種別に依存してうまく取り込めない(ARM CPU で構造体のアラインメントが異なる)のが原因のようです。<br/>
以前のバージョンのコンパイラ＋古いバージョンのAndroid デバイスでは動いていたような気がするのに。
原因は単純なので修正しておきました。</p>

<h4>Native Activity からのWakeLock の制御</h4>

<p>少し経つと画面が暗くなって、画面が非表示状態になります。
PowerManager のWakeLock を制御すれば良さそうです。
Android NDK のNative Activity の場合はJNI を経由してPower Manager へアクセスするのかな。
後で調べておこう。</p>

<h4>画面インタフェース</h4>

<ul>
<li><strong>パネル表示切替ボタン「⇅」</strong><br/>
画面下部の設定用のインタフェースの表示/非表示を切り替える。曲目リスト、モデルリスト、環境設定のタブがある。</li>
<li><strong>ミュート切替ボタン「♪」</strong><br/>
音声の出力状態を切り替える。OpenSL ES の<code>(*uriPlayerVolume)-&gt;SetMute()</code>をコールしている。</li>
<li><strong>再生/停止切替ボタン「▶」</strong><br/>
モーションと音声の再生/停止を切り替える。アニメーションスピードの切り替えと<code>(*uriPlayerPlay)-&gt;SetPlayState()</code>をコールしている。モデルまたは曲を変更した場合は最初から開始する。</li>
<li><strong>終了ボタン「×」</strong><br/>
アプリケーションを終了する。</li>
<li><strong>カメラ位置スクロールバー</strong><br/>
カメラの位置を前後させる。</li>
</ul>


<h4>TODO</h4>

<ul>
<li><code>state-&gt;onAppCmd</code> にコールバック関数を設定しているのにキックされない原因を調べる。</li>
<li><code>pFileSystem-&gt;createFileList()</code> が失敗する原因を調べる。</li>
<li>タスク復帰時に描画コンテキストをリストアする。</li>
<li>GUI のSkin を変更する。</li>
<li>Android 固有の入力イベントに対応する。</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Compiling Irrlicht ogl-es branch for Android]]></title>
    <link href="http://ktkr3d.github.io/blog/2013/08/04/compiling-irrlicht-ogl-es-branch-for-android/"/>
    <updated>2013-08-04T04:04:00+09:00</updated>
    <id>http://ktkr3d.github.io/blog/2013/08/04/compiling-irrlicht-ogl-es-branch-for-android</id>
    <content type="html"><![CDATA[<p><a href="http://ktkr3d.github.io/images/irrlicht_ogl-es_android.png"><img src="/images/irrlicht_ogl-es_android_tn.png"></a></p>

<ul>
<li>Compiling Irrlicht ogl-es branch for Android on Ubuntu GNOME 13.10 x86_64.</li>
<li>Native C/C++ Android Application (Native Activity).</li>
<li>Fullscreen (1080x1920)</li>
<li>Input Event Receiver</li>
<li>True Type Font (FreeType2)</li>
<li>OpenSL ES (Native Audio)</li>
</ul>


<!-- more -->


<h4>Environment</h4>

<ul>
<li>Android SDK: 22.0.5</li>
<li>Android NDK: r9</li>
<li>Android Device: Android 4.1.2 (API level 16)</li>
<li>Irrlicht 1.9 [r4528]</li>
</ul>


<h4>Download Irrlicht ogl-es branch</h4>

<p><code>http://sourceforge.net/p/irrlicht/code/</code></p>

<ol>
<li>Select <code>branches</code>, <code>ogl-es</code>, <code>Download Snapshot</code>.</li>
<li>Download.</li>
<li>Extract.</li>
</ol>


<h4>Compile Irrlicht Library</h4>

<p><code>bash
$ cd source/Irrlicht/Andorid
$ ndk-build -j4
</code></p>

<p>&ndash;> <code>lib/Android/libirrlicht.a</code></p>

<h4>Build example</h4>

<p><code>bash
$ cd examples/17.HelloWorld_Mobile
$ android update project --path . --target android-16
$ ndk-build -j4
$ ant debug
</code></p>

<p>&ndash;> <code>examples/17.HellowWorld_Mobile/HelloWorldMobile-debug.apk</code></p>

<h4>TrueType Font</h4>

<p><code>include/irrUString.h</code>, <code>jni/CGUITTFont.h</code>, <code>jni/CGUITTFont.cpp</code></p>
]]></content>
  </entry>
  
</feed>
